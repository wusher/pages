# Usage

Medusa provides three core commands for managing your static site: scaffolding new projects, building for production, and running a development server.

## Creating a New Site

Start a fresh project with the `new` command:

```bash
medusa new mysite
cd mysite
```

This creates a complete project structure with example layouts, partials, and starter content. The directory must be empty or non-existent.

## Building for Production

Generate your static site into the `output/` directory:

```bash
medusa build
```

The build process:
1. Compiles all Markdown and Jinja2 templates
2. Processes Tailwind CSS, including only used classes
3. Minifies JavaScript files with Terser
4. Generates sitemap.xml and RSS feed
5. Copies static assets

### Including Drafts

By default, files prefixed with `_` are treated as drafts and excluded from builds. Include them with:

```bash
medusa build --drafts
```

## Development Server

Run a local server with live reload for rapid development:

```bash
medusa serve
```

The server watches for file changes and automatically refreshes your browser. By default it runs on `localhost:4000`.

### Server Options

```bash
# Include draft content
medusa serve --drafts

# Custom port
medusa serve --port 3000

# Custom WebSocket port for live reload
medusa serve --ws-port 3001

# Enable verbose logging for debugging
medusa serve --debug
```

The WebSocket port defaults to your HTTP port plus one. Both ports can also be configured in `medusa.yaml`.

## Command Reference

| Command | Description |
|---------|-------------|
| `medusa new NAME` | Create a new project in the `NAME/` directory |
| `medusa build` | Build the site to `output/` |
| `medusa build --drafts` | Build including draft content |
| `medusa serve` | Start development server with live reload |
| `medusa serve --drafts` | Serve including draft content |
| `medusa serve --port PORT` | Use custom HTTP port |
| `medusa serve --ws-port PORT` | Use custom WebSocket port |
| `medusa serve --debug` | Enable verbose logging |

## Configuration

Optional settings can be placed in `medusa.yaml` at your project root:

```yaml
output_dir: output           # Output directory for built site
port: 4000                   # Development server port
ws_port: 4001                # WebSocket port for live reload
root_url: https://example.com/  # Root URL for the deployed site
```

Command-line flags override configuration file settings.

## Deployment

### GitHub Pages

Medusa works well with GitHub Actions for automated deployment. Create `.github/workflows/deploy.yml`:

```yaml
name: Deploy
on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.12'
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      - run: pip install medusa-ssg
      - run: npm install
      - run: medusa build
      - uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./output
```

### Other Hosting

The `output/` directory contains your complete static site. Deploy it to any static hosting service like Netlify, Vercel, or your own server.
